# Traefik configuration for OpenSlides

# Experimental plugins configuration
# The traefik-oidc-auth plugin is loaded via command-line arguments
# when using docker-compose.oidc.yml overlay:
#   --experimental.plugins.traefik-oidc-auth.modulename=github.com/sevensolutions/traefik-oidc-auth
#   --experimental.plugins.traefik-oidc-auth.version=v0.19.3

# Add provider to read routing config from file
providers:
  file:
    directory: ${DYNAMIC_DIR}
    watch: true

# Enable /ping for HEALTHCHECK on default traefik endpoint (:8080)
ping: {}

# Add logging config
log:
  level: ${TRAEFIK_LOG_LEVEL}

accessLog:
  fields:
    headers:
      defaultMode: keep
      names:
        Authorization: drop
        X-Forwarded-User: keep
        X-Auth-Request-Email: keep
        authentication: drop

# entryPoints are generated dynamically in entrypoint.sh script as their
# definitions depend on TLS configuration

